<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GCLM Flow Engine - 管理控制台</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>GCLM Flow</h1>
                <p>管理控制台</p>
            </div>
            <nav class="sidebar-nav">
                <a href="#dashboard" class="nav-item active" data-view="dashboard">
                    <span class="nav-icon">📊</span>
                    <span class="nav-label">仪表板</span>
                </a>
                <a href="#tasks" class="nav-item" data-view="tasks">
                    <span class="nav-icon">📋</span>
                    <span class="nav-label">任务管理</span>
                </a>
                <a href="#workflows" class="nav-item" data-view="workflows">
                    <span class="nav-icon">⚙️</span>
                    <span class="nav-label">工作流</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <div class="server-status" id="serverStatus">
                    <span class="status-indicator"></span>
                    <span class="status-text">连接中...</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard View -->
            <section id="dashboardView" class="view active">
                <header class="view-header">
                    <h2>仪表板</h2>
                    <p class="view-subtitle">系统概览和任务统计</p>
                </header>

                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon stat-total">📊</div>
                        <div class="stat-content">
                            <div class="stat-label">总任务数</div>
                            <div class="stat-value" id="statTotal">-</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon stat-running">🔄</div>
                        <div class="stat-content">
                            <div class="stat-label">运行中</div>
                            <div class="stat-value" id="statRunning">-</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon stat-completed">✅</div>
                        <div class="stat-content">
                            <div class="stat-label">已完成</div>
                            <div class="stat-value" id="statCompleted">-</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon stat-failed">❌</div>
                        <div class="stat-content">
                            <div class="stat-label">失败</div>
                            <div class="stat-value" id="statFailed">-</div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card">
                    <div class="card-header">
                        <h3>最近活动</h3>
                        <button class="btn-small" onclick="refreshDashboard()">刷新</button>
                    </div>
                    <div class="card-body">
                        <div id="recentActivity" class="activity-list">
                            <p class="loading">加载中...</p>
                        </div>
                    </div>
                </div>

                <!-- System Info -->
                <div class="card">
                    <div class="card-header">
                        <h3>系统信息</h3>
                    </div>
                    <div class="card-body">
                        <dl class="info-list">
                            <div class="info-item">
                                <dt>服务状态</dt>
                                <dd><span class="status-badge status-running">运行中</span></dd>
                            </div>
                            <div class="info-item">
                                <dt>服务版本</dt>
                                <dd id="systemVersion">v0.2.0</dd>
                            </div>
                            <div class="info-item">
                                <dt>监听地址</dt>
                                <dd id="serverAddr">http://localhost:9988</dd>
                            </div>
                            <div class="info-item">
                                <dt>服务端口</dt>
                                <dd id="systemPort">9988</dd>
                            </div>
                        </dl>
                    </div>
                </div>
            </section>

            <!-- Tasks View -->
            <section id="tasksView" class="view">
                <header class="view-header">
                    <h2>任务管理</h2>
                    <p class="view-subtitle">查看和管理所有任务</p>
                </header>

                <!-- Filters -->
                <div class="filters-bar">
                    <div class="filter-group">
                        <label>状态筛选:</label>
                        <select id="statusFilter">
                            <option value="">全部</option>
                            <option value="created">已创建</option>
                            <option value="running">运行中</option>
                            <option value="paused">已暂停</option>
                            <option value="completed">已完成</option>
                            <option value="failed">失败</option>
                            <option value="cancelled">已取消</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <input type="text" id="searchInput" placeholder="搜索任务描述或ID...">
                    </div>
                    <button class="btn-primary" onclick="refreshTasks()">刷新</button>
                </div>

                <!-- Tasks List -->
                <div class="card">
                    <div class="card-body card-body-padding-0">
                        <div id="tasksList" class="tasks-list">
                            <p class="loading">加载中...</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Workflows View -->
            <section id="workflowsView" class="view">
                <header class="view-header">
                    <h2>工作流管理</h2>
                    <p class="view-subtitle">查看可用的工作流配置</p>
                </header>

                <!-- Workflows List -->
                <div class="card">
                    <div class="card-body">
                        <div id="workflowsList" class="workflows-list">
                            <p class="loading">加载中...</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Task Detail Modal -->
    <div id="taskModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="modalTaskTitle">任务详情</h3>
                <div class="modal-actions" id="taskModalActions">
                    <!-- Actions will be dynamically inserted here -->
                </div>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalTaskBody">
                <p class="loading">加载中...</p>
            </div>
        </div>
    </div>

    <!-- Workflow Detail Modal -->
    <div id="workflowModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3 id="modalWorkflowTitle">工作流详情</h3>
                <div class="modal-actions">
                    <button class="btn-small" id="viewYamlBtn" onclick="viewWorkflowYAMLFromModal()">查看 YAML</button>
                    <button class="modal-close" onclick="closeWorkflowModal()">&times;</button>
                </div>
            </div>
            <div class="modal-body" id="modalWorkflowBody">
                <p class="loading">加载中...</p>
            </div>
        </div>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
